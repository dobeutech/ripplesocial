#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üîç Running pre-commit checks..."

# Type check
echo "üìù Type checking..."
npm run typecheck || {
  echo "‚ùå Type check failed. Fix errors before committing."
  exit 1
}

# Lint
echo "üîß Linting..."
npm run lint || {
  echo "‚ùå Lint check failed. Fix errors before committing."
  exit 1
}

# Check for console.log statements (warning only)
echo "üîé Checking for console statements..."
if git diff --cached --name-only | grep -E '\.(ts|tsx)$' | xargs grep -n "console\\.log" 2>/dev/null; then
  echo "‚ö†Ô∏è  Warning: console.log statements found. Consider removing them."
fi

# Check for TODO/FIXME comments in staged files
echo "üìã Checking for TODO/FIXME comments..."
if git diff --cached --name-only | grep -E '\.(ts|tsx)$' | xargs grep -n "TODO\|FIXME" 2>/dev/null; then
  echo "‚ö†Ô∏è  Warning: TODO/FIXME comments found in staged files."
fi

echo "‚úÖ Pre-commit checks passed!"
